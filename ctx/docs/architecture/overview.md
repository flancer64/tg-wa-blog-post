# Архитектурная форма системы

Path: `./ctx/docs/architecture/overview.md`

## Назначение уровня

Документ фиксирует архитектурную форму Telegram Translation Publisher как совокупность контуров, границ и фаз обработки. Уровень описывает структурную модель системы и её внешние интерфейсы без процедурных инструкций и без повторения продуктовых или эксплуатационных утверждений, закреплённых на других уровнях контекста.

## Тип системы

Система представляет собой детерминированный CLI-процесс пакетной обработки. Она не является long-running сервисом, не содержит постоянного цикла обработки событий и не владеет временем появления публикаций. Каждый запуск процесса образует изолированный акт синхронизации, завершающийся остановкой процесса.

## Внешние границы

Система взаимодействует с двумя внешними подсистемами: Telegram Bot API как источником и приёмником сообщений и внешним LLM API как средством языкового преобразования. Публикация исходного сообщения в ru-канале находится вне архитектурного контура системы. Каналы en и es рассматриваются как внешние целевые интерфейсы публикации.

## Архитектурные контуры

### Контур инициации

Инициация обработки осуществляется исключительно через CLI. Запуск формирует единичный жизненный цикл обработки без сохранения активного состояния после завершения.

### Контур получения публикации

Контур получения выполняет запрос к Telegram Bot API и извлекает последнее опубликованное сообщение из ru-канала. Обрабатываются только новые сообщения; редактирование ранее опубликованных сообщений не входит в архитектурную модель.

### Контур репликации

После получения исходного текста формируются два независимых репликационных подконтура: en и es. Каждый подконтур включает фазу языкового преобразования через внешний LLM API и фазу публикации результата в соответствующий канал. Подконтуры логически параллельны и не зависят друг от друга по результату выполнения.

### Контур фиксации состояния

Контур фиксации обеспечивает сохранение агрегата публикации в файловой структуре. Агрегат включает исходный текст, переводы для en и es, идентификатор исходного сообщения и связь между ними. Фиксация отражает входные и выходные данные завершённого цикла обработки.

### Контур ошибок

Контур ошибок фиксирует исключительные ситуации во время выполнения CLI-процесса. Ошибки не изменяют структурную форму системы и не создают отдельного жизненного цикла; результатом является логирование состояния выполнения.

## Фазы жизненного цикла запуска

Жизненный цикл одного запуска состоит из фаз получения исходного сообщения, разветвлённой репликации в два языковых канала и фиксации результата. При неуспехе одной из публикаций агрегат фиксируется в полном составе без выполнения отката других подконтуров, а итог классифицируется как неуспешный.

## Структурные свойства

Архитектура предполагает один процесс выполнения и отсутствие распределённого режима. Система не содержит внутренних очередей, фоновых задач или постоянного состояния в памяти между запусками. Каждое выполнение рассматривается как автономная транзакционная операция репликации.

## Итог

Архитектурная форма Telegram Translation Publisher определяется как однопроцессный CLI-инструмент репликации публикаций из ru-канала в en и es каналы с независимыми подконтурами языкового преобразования и публикации, внешними границами Telegram Bot API и LLM API и файловой фиксацией агрегата результата.
