# Внешние интерфейсы системы

Path: `./ctx/docs/architecture/external-interfaces.md`

## Назначение уровня

Документ фиксирует архитектурные границы Telegram Translation Publisher по отношению к внешним системам. Уровень описывает допустимые операции и контракты взаимодействия без привязки к конкретным библиотекам, форматам HTTP-запросов или техническим деталям реализации.

## Общая модель внешнего взаимодействия

Система взаимодействует с двумя внешними интерфейсами: Telegram Bot API как средством получения и публикации сообщений и внешним LLM API как средством языкового преобразования. Оба интерфейса рассматриваются как внешние по отношению к доменной модели и не входят во внутреннюю структуру агрегата.

---

## Интерфейс Telegram Bot API

### Назначение

Telegram Bot API используется для чтения исходного сообщения из ru-канала и публикации производных сообщений в en и es каналах.

### Допустимые операции

В рамках архитектурной модели допускаются следующие классы операций:

- Получение последнего сообщения из ru-канала.
- Публикация текстового сообщения в en-канал.
- Публикация текстового сообщения в es-канал.

Операции редактирования сообщений, удаления сообщений, обработки медиа-контента и подписки на события не входят в архитектурную модель.

### Модель входных данных (из Telegram)

Получаемое сообщение рассматривается как атомарная текстовая публикация и включает:

- `message_id`
- текст сообщения с форматированием
- эксплуатационные атрибуты публикации (включая время)

Медиа-вложения и дополнительные типы контента не входят в поддерживаемую модель.

### Модель выходных данных (в Telegram)

При публикации в en и es каналы формируется текстовое сообщение, содержащее результат языкового преобразования. Результатом операции публикации является идентификатор опубликованного сообщения (`message_id`) и эксплуатационные атрибуты, используемые для фиксации агрегата.

---

## Интерфейс LLM API

### Назначение

LLM API используется для языкового и культурного преобразования исходного текста ru в целевой язык (en или es) при сохранении смыслового ядра.

### Контракт преобразования

Входом в LLM API является:

- исходный текст ru;
- конфигурационный системный промпт, соответствующий целевому языку.

Выходом является:

- текст перевода на целевом языке;
- без дополнительных структурных объектов доменной модели.

LLM API рассматривается как детерминированный преобразователь текста в текст в рамках одного запроса. Архитектура не предполагает пакетных запросов, объединяющих несколько языков в одном вызове.

### Ограничения взаимодействия

- Для каждого языка выполняется отдельный вызов.
- Повторный вызов для одного и того же языка в рамках одного запуска не допускается.
- Промпты относятся к конфигурационному уровню и не входят в доменную модель агрегата.

---

## Граница ответственности

Telegram Bot API отвечает за доставку и публикацию сообщений. LLM API отвечает исключительно за текстовое преобразование. Система не переносит в доменную модель внутренние механизмы внешних API и не формирует зависимостей от их внутреннего устройства.

## Итог

Внешние интерфейсы Telegram Translation Publisher ограничены чтением и публикацией текстовых сообщений через Telegram Bot API и независимыми текстовыми преобразованиями через LLM API. Взаимодействие описывается на уровне декларативных контрактов «текст → текст» и «сообщение → сообщение» без расширения функциональной области системы.
