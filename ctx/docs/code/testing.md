# Testing Contract

Path: `./ctx/docs/code/testing.md`

## Назначение

Документ фиксирует правила тестирования Telegram Translation Publisher на уровне unit-тестов. Уровень определяет требования к изоляции, DI-модели и инструментам.

## Обязательность тестов

Для всех `.mjs`-модулей в `src/` наличие unit-тестов является обязательным.

Entry-point (bootstrap) может не покрываться тестами.

## DI в тестах

Каждый тест:

- создаёт собственный DI-контейнер;
- обязан вызывать `enableTestMode()`.

Использование production bootstrap в тестах запрещено.

## Импорт production-кода

Статический импорт production-модулей в тестах запрещён.

Доступ к production-коду осуществляется исключительно через:

```txt
container.get()
```

## Изоляция и побочные эффекты

В unit-тестах запрещён реальный доступ к:

- `/var/data`;
- Telegram API;
- LLM API.

Все внешние зависимости должны мокироваться через DI.

Использование временных каталогов не требуется.

## Типы тестов

Поддерживаются только unit-тесты.

Интеграционные тесты не входят в контракт текущего продукта.

## Инструменты

Разрешены только стандартные средства Node.js:

- `node:test`;
- `node:assert/strict`.

Использование сторонних библиотек тестирования запрещено.

## Логирование в тестах

Мокирование Logger не требуется.

`console.log` разрешён внутри тестов.

## Параллельность

Параллельный запуск тестов допускается.

Тесты должны быть полностью изолированы и не зависеть друг от друга.

## Покрытие

Минимальный процент покрытия кода не фиксируется в рамках текущего контракта.

## Итог

Testing-контракт Telegram Translation Publisher закрепляет обязательные unit-тесты для всех production-модулей, строгую DI-изоляцию, запрет на побочные эффекты и использование только стандартных средств Node.js.
