# Инженерный контекст кода (`./ctx/docs/code/`)

Path: `./ctx/docs/code/AGENTS.md`

## Назначение

Каталог `ctx/docs/code/` фиксирует инженерные нормы реализации: границы модулей, правила запуска, конфигурации, обработку ошибок, тестирование, логирование и контракты прикладного слоя. Уровень определяет инварианты кодовой организации без подмены архитектурных описаний, продуктовых смыслов и организационных инструкций ветви `ctx/agent/`.

## Карта уровня

- `configuration/` — вложенный контекст правил структуры и представления конфигурации приложения.
- `external/` — локальные контракты интеграции с внешними API на уровне кодовых адаптеров.
- `storage/` — правила и границы слоя файлового хранения агрегатов.
- `testing/` — нормативные документы composition root для test-зон.
  - `testing/unit-bootstrap.md` — контракт test composition root для unit-тестов.
  - `testing/dev-bootstrap.md` — контракт test composition root для dev-тестов.
- `AGENTS.md` — текущий документ уровня `code/`, задающий его границы и требования.
- `aggregate.md` — нормы структуры и поведения агрегата публикации в коде.
- `app-contract.md` — контракт прикладного слоя и правила взаимодействия с доменными сценариями.
- `bootstrap.md` — инварианты инициализации приложения и сборки runtime-контекста.
- `cli.md` — правила CLI-входа, параметров запуска и пользовательского интерфейса командной строки.
- `configuration.md` — общие нормы конфигурации и источников параметров приложения.
- `di.md` — правила композиции зависимостей и контрактов контейнера.
- `error-handling.md` — инварианты классификации и обработки ошибок.
- `logging.md` — правила наблюдаемости, формата и уровней логирования.
- `output.md` — служебный файл вывода, который не входит в когнитивный контекст и игнорируется агентом.
- `testing.md` — общий Testing Contract (unit + dev).

## Границы уровня

Уровень `code/` ограничен инженерной нормативной моделью реализации и не включает:

- продуктовые определения;
- архитектурную форму системы;
- операционные регламенты поведения агента.

Документы уровня описывают обязательные свойства кода декларативно, без процедурных инструкций выполнения задач.

Dev-тестирование, несмотря на допуск реальных side effects, относится к инженерной модели проверки кода и не изменяет архитектурный или продуктовый контракт системы.

## Composition Root Model

В системе существует ровно один production composition root — bootstrap.

Test-зоны используют собственные composition root:

- `unit-bootstrap` — для изолированного unit-тестирования без side effects;
- `dev-bootstrap` — для интеграционной проверки фрагментов системы в реальном окружении.

Наличие test composition root не создаёт альтернативного режима исполнения приложения и не расширяет CLI-контракт.

## Требования

1. Новые документы уровня добавляются только для фиксации инженерных инвариантов и не дублируют утверждений из `ctx/docs/architecture/` и `ctx/docs/product/`.
2. При изменении состава каталога `ctx/docs/code/` раздел «Карта уровня» обновляется синхронно и остаётся навигационно точным.
3. Текст внутри абзацев оформляется без ручных переносов строк.
4. Любые изменения тестовой модели не должны приводить к появлению второго production composition root или альтернативных режимов CLI.

## Итог

`ctx/docs/code/AGENTS.md` определяет границы инженерного уровня и фиксирует навигацию по документам, описывающим кодовые инварианты Telegram Translation Publisher. Уровень включает нормативную модель unit- и dev-тестирования, сохраняя единственный production composition root и неизменность архитектурных инвариантов.
