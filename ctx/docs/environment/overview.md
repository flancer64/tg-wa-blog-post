# Эксплуатационная среда исполнения

Path: `./ctx/docs/environment/overview.md`

## Назначение уровня

Документ фиксирует требования к эксплуатационной среде Telegram Translation Publisher. Уровень описывает характеристики операционной системы, runtime, конфигурационного окружения, файловой структуры и модели обновления без перехода к архитектурным решениям, инженерной реализации и прикладной композиции выполнения.

## Операционная среда

Система предназначена для исполнения в POSIX-совместимой среде. Конкретный дистрибутив операционной системы не фиксируется. Запуск осуществляется вручную через SSH-сеанс. Среда не предполагает постоянного сервиса, демона или планировщика как архитектурной обязанности приложения.

## Node.js runtime

Среда обязана предоставлять Node.js LTS с целевой версией 20.x. Исполнение осуществляется нативно без шага транспиляции или сборки во время запуска. Runtime должен поддерживать ESM-модули без использования промежуточных компиляторов. Приложение запускается локально внутри каталога проекта через установленный в системе `node`. Глобальная установка пакета не предусматривается.

## Конфигурационная модель среды

Конфигурация определяется переменными окружения. Файл `.env` может использоваться, но не является обязательным при наличии соответствующих переменных в системном окружении. При наличии файл `.env` размещается в корне проекта. Отсутствие любой обязательной переменной окружения приводит к немедленному завершению процесса с кодом ошибки.

## Файловая система

Каталоги `/var/data/` и `/var/prompt/` являются жёстко фиксированными путями среды. Переопределение этих путей через конфигурацию не допускается. Среда предполагает наличие прав доступа, достаточных для записи агрегатов в `/var/data/` и чтения промптов из `/var/prompt/`. Управление архивированием или ротацией агрегатов относится к уровню операционной системы и не входит в ответственность приложения.

## Сетевая модель

Среда предполагает возможность сетевого взаимодействия с внешними интерфейсами Telegram Bot API и LLM API. Детализация сетевой конфигурации, TLS и маршрутизации не фиксируется на уровне данного документа.

## Логирование

Приложение выводит сообщения исключительно в стандартный поток вывода (stdout). Среда не обеспечивает persistent-логирование по умолчанию. История выполнения не рассматривается как часть устойчивого состояния системы. Единственным источником истины для факта обработки сообщений является файловое хранилище агрегатов.

## Безопасность среды

Файл `.env`, при его наличии, должен быть недоступен публичному доступу и иметь ограниченные права чтения. Секреты и токены не должны выводиться в логах. Управление пользователями операционной системы не относится к обязанностям приложения.

## Обновление и деплой

Обновление приложения осуществляется через GitHub Actions, который выполняет сборку зависимостей и развёртывание проекта на сервере. Среда не предусматривает миграцию архивных агрегатов при обновлении версии приложения. Агрегаты разных версий могут сосуществовать в каталоге `/var/data/`. Приложение не обращается к историческим агрегатам и не интерпретирует их структуру в процессе выполнения.

## Итог

Эксплуатационная среда Telegram Translation Publisher представляет собой POSIX-совместимое окружение с Node.js LTS 20.x, локальным запуском через `node`, фиксированной файловой структурой `/var/data/` и `/var/prompt/`, отсутствием персистентного логирования и обновлением через автоматизированный CI-процесс без ретро-обработки архива.
