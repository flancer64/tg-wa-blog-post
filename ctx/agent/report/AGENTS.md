# Протокол фиксации итераций агента

- Path: `ctx/agent/report/AGENTS.md`
- Version: `20251218`

## Назначение каталога

Каталог `ctx/agent/report/` предназначен для хранения отчётов по рабочим итерациям агента. Каждый отчёт фиксирует завершённую итерацию и подтверждает, что изменения контекста и связанных артефактов согласованы и зафиксированы.

## Карта уровня

- `YYYY/` — архив итерационных отчётов, организованных по годам с вложенной структурой месяцев и дней.
- `AGENTS.md` — текущий документ, определяющий требования к отчётности и структуре каталога `report/`.

## Обязательные правила

- Каждая итерация завершается созданием отдельного отчёта с путём  
  `ctx/agent/report/YYYY/MM/DD/HH-MM-{title}.md`.
- Отчёт содержит как минимум три смысловых блока:
  - «Резюме изменений»
  - «Детали работ»
  - «Результаты»
- Отчёт отражает связь между постановкой задачи человеком, изменениями в контексте и правками в продуктовых или кодовых артефактах.
- Отсутствие отчёта означает, что итерация не завершена и не может считаться зафиксированной.

## Политика неизменяемости отчётов

- **Отчёт является неизменяемым документом.**
- **Запрещено редактирование отчёта после его создания.**
- Допускается **только удаление** отчёта, если он признан ошибочным или нерелевантным.
- Повторная фиксация выполняется исключительно путём создания **нового файла**, а не изменением существующего.
- Рекомендуется помечать отчёты как `read-only`, чтобы исключить случайные правки.
- Каталог `ctx/agent/report/` рассматривается как архив: агент не читает, не анализирует и не модифицирует существующие отчёты без явного указания человека.

## Алгоритм действий агента

1. По завершении итерации сформировать содержание отчёта.
2. Убедиться, что иерархия каталогов по дате существует; при необходимости создать её.
3. Сохранить отчёт в формате Markdown с уникальным суффиксом `{title}`.
4. Зафиксировать файл вместе с остальными изменениями итерации.
5. Обеспечить неизменяемость созданного отчёта.

## Дополнительные указания

- Суффикс `{title}` должен кратко отражать суть итерации (например, `structure-update`, `docs-sync`, `bugfix`).
- Повторные или уточняющие итерации оформляются отдельными отчётами без перезаписи предыдущих.
- Если итерация включает изменения контекста, в отчёте указываются ссылки на соответствующие документы.
- Отчёты предназначены для человека и исторической фиксации; они не используются агентом как рабочий контекст по умолчанию.

## Итог

`ctx/agent/report/AGENTS.md` задаёт единый, переносимый протокол фиксации итераций, обеспечивая прозрачную историю изменений и строгую границу между текущей работой агента и архивом завершённых шагов.
